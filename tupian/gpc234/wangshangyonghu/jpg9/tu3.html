<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 网页标题（显示在浏览器标签页，搜索引擎优先抓取） -->
 <title>网上用户的图片</title>
    <meta name="keywords" content="网上用户的图片,搜索:网上用户,网上用户,上网用户,用户,公平村,GPC234,GPCZXS" /><!--关键词-->
     <!-- 可选：网页描述（用于搜索引擎结果展示） -- 
<meta name="description" content="网上用户的图片" />

  <!-- CSS样式定义部分 -->
    <style type="text/css">
      /* 为所有的a标签设置样式 */
      a {
        text-decoration: none; /* 去除a标签的下划线 */
        font-weight: bold; /* 为a标签设置粗体样式 */
        font-size: 18px; /* 为a标签设置字体大小为18像素 */
      }
    </style>


    <!-- 可选：可以添加样式美化下载链接和图片 -->
    <style>
        .download-container {
            text-align: center;
            margin: 20px auto;
            max-width: 400px;
        }
        .download-link {
            display: inline-block;
        }
        #gpcjpg {
            border: 1px solid #eee;
            border-radius: 4px;
            padding: 5px;
        }
    </style>
</head>

<body>
    <div class="download-container">
<h1>网上用户的图片</h1>

        <a href="" class="download-link" download="保存的图片.jpg">
            <img id="gpcjpg" src="" width="330" height="" title="点击下载图片" align="" alt="搜索:网上用户的图片,网上用户,上网用户,用户,公平村,GPC234,GPCZXS">
        </a>
    </div>

    <script>
        // 获取当前页面URL
        var currentUrl = window.location.href;
        // 从URL中提取数字（匹配xxx数字.html格式）
        var match = currentUrl.match(/(\d+)\.html/);
        if (match) {
            var number = match[1];
            // 构建图片地址
            var imgPath = './' + number + '.jpg';
            // 获取图片元素和链接元素
            var img = document.getElementById('gpcjpg');
            var link = document.querySelector('.download-link');
            // 设置图片路径和下载链接
            if (img) {
                img.src = imgPath;
                // 可选：图片加载失败时显示默认提示
                img.onerror = function() {
                    this.alt = '图片加载失败';
                }
            }
            if (link) link.href = imgPath;
        } else {
            // 如果URL中没有数字，显示提示
            var img = document.getElementById('gpcjpg');
            if (img) img.alt = '未找到有效的图片ID';
        }
    </script>



<!--自动随机图片-->
<!-- 第1张随机图片 -->
<a href="" class="download-link" download="保存的图片1.jpg">
  <img id="randomJpg1" src="" alt="网上用户的图片,搜索:网上用户,公平村,GPC234,GPCZXS" width="280" style="height: auto; margin: 10px;" />
</a>

<script>
// 1. 生成指定范围的随机数（工具函数）
const getRandomNumber = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
// 2. 完整配置项（保留原代码所有目录、域名，无任何省略）
const baseConfig = {
 imageSources: [ // 基础域名/根目录（一级源）
    '/',    // 网站根目录（已修复，可正常使用）
    'http://gpc234.66ghz.com',
    ],


  folderPaths: [  // 完整保留所有原始图片目录
      '',
      './',
      '/tupian/gpc234/wangshangyonghu/jpg1/',
    '/tupian/gpc234/wangshangyonghu/jpg2/',
    '/tupian/gpc234/wangshangyonghu/jpg3/',
    '/tupian/gpc234/wangshangyonghu/jpg4/',
    '/tupian/gpc234/wangshangyonghu/jpg5/',
    '/tupian/gpc234/wangshangyonghu/jpg6/',
    '/tupian/gpc234/wangshangyonghu/jpg7/',
    '/tupian/gpc234/wangshangyonghu/jpg8/',
    '/tupian/gpc234/wangshangyonghu/jpg9/',
    '/tupian/gpc234/wangshangyonghu/jpg10/',
    '/tupian/gpc234/wangshangyonghu/jpg11/',
    '/tupian/gpc234/wangshangyonghu/jpg12/',
    '/tupian/gpc234/wangshangyonghu/jpg13/',
    '/tupian/gpc234/wangshangyonghu/jpg14/',
    '/tupian/gpc234/wangshangyonghu/jpg15/',
    '/tupian/gpc234/wangshangyonghu/jpg16/',
    '/tupian/gpc234/wangshangyonghu/jpg17/',
    '/tupian/gpc234/wangshangyonghu/jpg18/',
    '/tupian/gpc234/wangshangyonghu/jpg19/',
    '/tupian/gpc234/wangshangyonghu/jpg20/',
    '/tupian/gpc234/wangshangyonghu/jpg21/',
    '/tupian/gpc234/wangshangyonghu/jpg22/',
    '/tupian/gpc234/wangshangyonghu/jpg23/',
    '/tupian/gpc234/wangshangyonghu/jpg24/',
    '/tupian/gpc234/wangshangyonghu/jpg25/',
    '/tupian/gpc234/wangshangyonghu/jpg26/',
    '/tupian/gpc234/wangshangyonghu/jpg27/',
    '/tupian/gpc234/wangshangyonghu/jpg28/',
    '/tupian/gpc234/wangshangyonghu/jpg29/',
    '/tupian/gpc234/wangshangyonghu/jpg30/',
    '/tupian/gpc234/wangshangyonghu/jpg31/',
    '/tupian/gpc234/wangshangyonghu/jpg32/',
    '/tupian/gpc234/wangshangyonghu/jpg33/',
    '/tupian/gpc234/wangshangyonghu/jpg34/',
    '/tupian/gpc234/wangshangyonghu/jpg35/',
    '/tupian/gpc234/wangshangyonghu/jpg36/',
    '/tupian/gpc234/wangshangyonghu/jpg37/',
    '/tupian/gpc234/wangshangyonghu/jpg38/',
    '/tupian/gpc234/wangshangyonghu/jpg39/',
    '/tupian/gpc234/wangshangyonghu/jpg40/',
    '/tupian/gpc234/wangshangyonghu/jpg41/',
    '/tupian/gpc234/wangshangyonghu/jpg42/',
    '/tupian/gpc234/wangshangyonghu/jpg43/',
    '/tupian/gpc234/wangshangyonghu/jpg44/',
    '/tupian/gpc234/wangshangyonghu/jpg45/',
    '/tupian/gpc234/wangshangyonghu/jpg46/',
    '/tupian/gpc234/wangshangyonghu/jpg47/',
    '/tupian/gpc234/wangshangyonghu/jpg48/',
    '/tupian/gpc234/wangshangyonghu/jpg49/',
    '/tupian/gpc234/wangshangyonghu/jpg50/'

  ],

 
  numberRange: {  // 图片编号范围
    original: [1, 1000], // 主编号范围
    fallback: [1, 1]    // 备用编号范围
  },
  maxRetry: 50,   // 最大重试次数
  retryDelay: 500 // 重试间隔（毫秒）
};

// 3. 核心逻辑：初始化单张图片的随机加载（保留原修复逻辑）
function initSingleRandomImage(imgId, baseConfig) {
  const img = document.getElementById(imgId);
  if (!img) {
    console.error('未找到图片元素，ID:', imgId);
    return;
  }

  // 获取当前图片对应的a标签（下载链接）
  const downloadLink = img.parentElement;

  let triedCombinations = new Set(); // 记录已尝试的（源+目录）组合
  let usingFallbackNumber = false;   // 是否使用备用编号
  let retryCount = 0;  // 当前重试次数

  // 修复核心：正确拼接路径（处理根目录/域名场景，避免双斜杠）
  function getRandomImageUrl() {
    const totalCombinations = baseConfig.imageSources.length * baseConfig.folderPaths.length;
    // 所有组合尝试完毕：重置状态，避免无法重试
    if (triedCombinations.size >= totalCombinations) {
      triedCombinations.clear();
      usingFallbackNumber = false;
      retryCount = 0;
      return null;
    }

    // 找到未尝试过的（源+目录）组合
    while (true) {
      const randomSource = baseConfig.imageSources[getRandomNumber(0, baseConfig.imageSources.length - 1)];
      const randomFolder = baseConfig.folderPaths[getRandomNumber(0, baseConfig.folderPaths.length - 1)];
      const combinationKey = `${randomSource}|${randomFolder}`;

      if (!triedCombinations.has(combinationKey)) {
 triedCombinations.add(combinationKey);
 // 选择编号范围（主/备用）
 const [minNum, maxNum] = usingFallbackNumber 
   ? baseConfig.numberRange.fallback 
   : baseConfig.numberRange.original;
 const randomNum = getRandomNumber(minNum, maxNum);

 // 路径清洗：移除目录开头的斜杠，避免根目录拼接时出现双斜杠
 const cleanedFolder = randomFolder.startsWith('/') ? randomFolder.slice(1) : randomFolder;
 let imageUrl;

 if (randomSource === '/') {
   // 根目录场景：正确拼接为 "/目录/编号.jpg"
   imageUrl = `${randomSource}${cleanedFolder}${randomNum}.jpg`;
 } else {
   // 域名场景：移除域名结尾斜杠（若有），拼接为 "域名/目录/编号.jpg"
   imageUrl = `${randomSource.replace(/\/$/, '')}/${cleanedFolder}${randomNum}.jpg`;
 }

 return imageUrl;
      }
    }
  }

  // 加载图片（含失败重试逻辑）
  function loadImage() {
    if (retryCount >= baseConfig.maxRetry) {
      img.src = '';
      img.alt = '网上用户的图片（加载失败）';
      console.warn('已达最大重试次数，停止加载');
      return;
    }

    const imageUrl = getRandomImageUrl();
    if (!imageUrl) {
      retryCount++;
      if (retryCount >= baseConfig.maxRetry) {
 img.src = '';
 img.alt = '网上用户的图片（加载失败）';
 console.warn('无可用图片组合，停止加载');
 return;
      }
      console.log(`无可用组合，重试中（${retryCount}/${baseConfig.maxRetry}）`);
      setTimeout(loadImage, baseConfig.retryDelay);
      return;
    }

    // 尝试加载图片
    img.src = imageUrl;
    // 同步更新下载链接的href
    downloadLink.href = imageUrl;
    console.log(`尝试加载（${retryCount + 1}/${baseConfig.maxRetry}）:`, imageUrl);
  }

  // 加载成功：重置状态
  img.addEventListener('load', () => {
    img.alt = '网上用户的图片,搜索:网上用户,公平村,GPC234,GPCZXS';
    // 确保下载链接与最终加载的图片地址一致
    downloadLink.href = img.src;
    console.log('图片加载成功:', img.src);
    triedCombinations.clear();
    usingFallbackNumber = false;
    retryCount = 0;
  });

  // 加载失败：切换备用编号/组合重试
  img.addEventListener('error', () => {
    console.error('加载失败:', img.src);
    retryCount++;

    // 1次失败后切换备用编号范围
    if (!usingFallbackNumber && retryCount >= 1) {
      usingFallbackNumber = true;
      console.log('切换到备用编号范围（1-13）重试');
    }

    setTimeout(loadImage, baseConfig.retryDelay);
  });

  // 初始加载图片
  loadImage();
}

// 4. 批量初始化所有图片（需与上方<img>标签的id对应）
const imageIds = ['randomJpg1', 'randomJpg2', 'randomJpg3', 'randomJpg4']; // 如需更多图片，在此处添加id（如'randomJpg4'）
imageIds.forEach(imgId => {
  initSingleRandomImage(imgId, baseConfig);
});
</script>
<!--自动随机图片-->















<hr/>

<!--上下页-->
  <a href="/" target="_blank">返回</a>
   <a href="javascript:void(0)" onclick="goToPreviousPage()">上一页</a>
<a href="javascript:void(0)" onclick="goToNextPage()">下一页</a>

<script>
// 提取文件名中的数字部分
function getPageNumber() {
    var currentPage = window.location.pathname.split('/').pop();
    // 从文件名中提取数字
    var numbers = currentPage.match(/\d+/);
    if (numbers && numbers.length > 0) {
        return parseInt(numbers[0]);
    }
    return null;
}

// 获取文件名中的前缀部分（数字前的内容）
function getPagePrefix() {
    var currentPage = window.location.pathname.split('/').pop();
    // 匹配数字前的所有字符
    var prefixMatch = currentPage.match(/^(\D*)\d+/);
    if (prefixMatch && prefixMatch.length > 1) {
        return prefixMatch[1];
    }
    return '';
}

function goToNextPage() {
    var pageNumber = getPageNumber();
    if (pageNumber !== null) {
        var prefix = getPagePrefix();
        var nextPageNumber = pageNumber + 1;
        var nextPage = './' + prefix + nextPageNumber + '.html';
        window.open(nextPage, '_blank'); // 在新窗口打开下一页
    } else {
        alert('无法识别当前页码');
    }
}

function goToPreviousPage() {
    var pageNumber = getPageNumber();
    if (pageNumber !== null && pageNumber > 1) {
        var prefix = getPagePrefix();
        var previousPageNumber = pageNumber - 1;
        var previousPage = './' + prefix + previousPageNumber + '.html';
        window.open(previousPage, '_blank'); // 在新窗口打开上一页
    } else {
        alert('已经是第一页或无法识别当前页码');
    }
}
</script><!--上下页-->

<!--底下显示-->
<a href="/gpc234/wangshangyonghu/sy/sy1.html" target="_blank">友情链接:gpc234</a>
<hr style=" height:5px;border:none;border-top:2px dotted #ff3844;" />
 <script src="/gpc234/wangshangyonghu/js/tua.js"></script>
<div id="gpczxstua"></div>
<hr style=" height:5px;border:none;border-top:2px dotted #ff3844;" />
<!--底下显示-->


</body>
</html>